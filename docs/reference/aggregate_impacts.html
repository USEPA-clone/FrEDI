<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact year estimates) — aggregate_impacts • FrEDI</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact year estimates) — aggregate_impacts"><meta property="og:description" content="Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact estimate years)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FrEDI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact year estimates)</h1>
    
    <div class="hidden name"><code>aggregate_impacts.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact estimate years).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aggregate_impacts</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  aggLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"national"</span>, <span class="st">"modelaverage"</span>, <span class="st">"impactyear"</span>, <span class="st">"impacttype"</span><span class="op">)</span>,</span>
<span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"annual_impacts"</span><span class="op">)</span>,</span>
<span>  groupByCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sector"</span>, <span class="st">"variant"</span>, <span class="st">"impactYear"</span>, <span class="st">"impactType"</span>, <span class="st">"model_type"</span>,</span>
<span>    <span class="st">"model"</span>, <span class="st">"region"</span><span class="op">)</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Data frame of results FrEDI (outputs from <code><a href="run_fredi.html">run_fredi()</a></code>)</p></dd>


<dt>aggLevels</dt>
<dd><p>Levels of aggregation at which to summarize data: one or more of <code>c("national"</code>, <code>"modelAverage"</code>, <code>"impactYear"</code>, <code>"impactType"</code>, <code>"all")</code>. Defaults to all levels (i.e., <code>aggLevels="all"</code>).</p></dd>


<dt>columns</dt>
<dd><p>Character vector of columns for which to aggregate results (defaults to <code>columns=c("annual_impacts"</code>)).</p></dd>


<dt>groupByCols</dt>
<dd><p>Character vector indicating which columns to use for grouping. Defaults to <code>groupByCols=</code>c("sector"<code>, </code>"variant"<code>, </code>"impactYear"<code>, </code>"impactType"<code>, </code>"model_type"<code>, </code>"model"<code>, </code>"region")<code>. Note that the </code>"variant"<code>column referred to below contains information about the adaptation or variant name or</code>“N/A”`, as applicable.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The output of <code><a href="run_fredi.html">run_fredi()</a></code> is an R data frame object containing annual average impacts, by year (2010-2090), summarized at the specified aggregation and grouping levels.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This post-processing helper function aggregates and summarizes the FrEDI results to levels of aggregation specified by the user (passed to <code>aggLevels</code>). Users can specify a single aggregation level or multiple aggregation levels by passing a single character string or character vector to <code>aggLevels</code>. Options for aggregation include calculating national totals (<code>aggLevels="national"</code>), averaging across model types and models (<code>aggLevels="modelAverage"</code>), summing over all impact types (<code>aggLevels="impactType"</code>), and interpolating between impact year estimates (<code>aggLevels="impactYear"</code>). Users can specify all aggregation levels at once by specifying <code>aggLevels="all"</code> (default).
This post-processing helper function aggregates and summarizes temperature binning results to levels of aggregation specified by the user (passed to <code>aggLevels</code>). Users can specify a single aggregation level or multiple aggregation levels by passing a single character string or character vector to <code>aggLevels</code>. Options for aggregation include calculating national totals (<code>aggLevels="national"</code>), averaging across model types and models (<code>aggLevels="modelaverage"</code>), summing over all impact types (<code>aggLevels="impacttype"</code>), and interpolate between impact year estimates (<code>aggLevels="impactyear"</code>). Users can specify all aggregation levels at once by specifying <code>aggLevels="all"</code> (default) or no aggregation levels (<code>aggLevels="none"</code>).</p>
<p>Before aggregating impacts for national totals and/or model averages, <code>aggregate_impacts()</code> will drop any pre-summarized results  (i.e., values for which <code>region="National Total"</code> and/or for which <code>model="average"</code>, respectively) that are already present in the data `and then reaggregate at those levels.</p>
<p>For each of the <code>aggLevels</code>, <code>aggregate_impacts()</code> performs the following summarization (note that the <code>"variant"</code> column referred to below contains information about the adaptation or variant name or <code>“N/A”</code>, as applicable):</p><table class="table table"><tr><td><strong>Aggregation Level</strong></td><td><strong>Description</strong></td></tr><tr><td><code>national</code></td><td>Annual values are summed across all regions present in the data. I.e., data is grouped by columns <code>"sector"</code>, <code>"variant"</code>, <code>"impactType"</code>,  <code>"impactYear"</code>, <code>"model_type"</code>, <code>"model"</code>, and <code>"year"</code>) and summed across regions. Years which have missing column data for all regions return as <code>NA</code>. The rows of the data frame of national values (with column <code>region="National Total"</code>) are then added as rows to the results.</td></tr><tr><td><code>modelaverage</code></td><td>For temperature-driven sectors, annual results are averaged across all GCM models present in the data. I.e., data is grouped by columns <code>"sector"</code>, <code>"variant"</code>, <code>"impactType"</code>, <code>"impactYear"</code>, <code>"model_type"</code>, <code>"region"</code>, and <code>"year"</code> and averaged across models (SLR impacts are estimated as an interpolation between SLR scenarios). Averages exclude missing values. Years which have missing column data for all models return as <code>NA</code>. The rows of model averages (with column <code>model="Average"</code> are then added as rows to the results data frame.</td></tr><tr><td><code>impactType</code></td><td>Annual results are summed across all impact types by sector present in the data. I.e., data is grouped by columns <code>"sector"</code>, <code>"variant"</code>, <code>"impactType"</code>, <code>"impactYear"</code>,<code>"model_type"</code>, <code>"model"</code>, <code>"region"</code>, and <code>"year"</code> and summed across impact types. Mutates column <code>impactType="all"</code> for all values. Years which have missing column data for all impact types return as <code>NA</code>. If results are aggregated across impact types, information about physical impacts (columns <code>"physicalmeasure"</code> and <code>"physical_impacts"</code>) are dropped.</td></tr><tr><td><code>impactYear</code></td><td>Annual results for sectors with only one impact year estimate (i.e., <code>impactYear == "N/A"</code>) are separated from those with multiple impact year estimates. For sectors with multiple impact years (i.e. 2010 and 2090 socioeconomic runs), annual results are interpolated between impact year estimates for applicable sectors  i.e., data is grouped by columns <code>"sector", "variant", "impactType, "model_type", "model", "region", "year"</code> and interpolated across years with the 2010 run assigned to year 2010 and the 2090 run assigned to year 2090. The interpolated values are bound back to the results for sectors with a single impact year estimate, and column <code>impactYear</code> set to <code>impactYear="Interpolation"</code> for all values.</td></tr></table><p>Note that <code>aggregate_impacts()</code> drops columns not used in grouping or aggregation.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Environmental Protection Agency (EPA). 2021. Technical Documentation on The Framework for Evaluating Damages and Impacts (FrEDI). Technical Report EPA 430-R-21-004, EPA, Washington, DC. Available at <a href="https://epa.gov/cira/FrEDI/" class="external-link">https://epa.gov/cira/FrEDI/</a>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Create temperature binning scenario</span></span></span>
<span class="r-in"><span><span class="va">df_tempExOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="run_fredi.html">run_fredi</a></span><span class="op">(</span>aggLevels<span class="op">=</span><span class="st">"none"</span>, pv<span class="op">=</span><span class="cn">TRUE</span>, silent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input values...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating temperature scenario from defaults...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating SLR scenario from temperature scenario...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating GDP scenario from defaults...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating Population scenario from defaults...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting results...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Aggregate temperature binning summary across multiple columns</span></span></span>
<span class="r-in"><span><span class="va">agg_tempExOut</span> <span class="op">&lt;-</span> <span class="va">df_tempExOut</span> <span class="op">%&gt;%</span> <span class="fu">aggregate_impacts</span><span class="op">(</span>columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"annual_impacts"</span>, <span class="st">"discounted_impacts"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	Interpolating between impact year estimates...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	Calculating model averages...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	Calculating national totals...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	Summing across impact types...</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by .</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

